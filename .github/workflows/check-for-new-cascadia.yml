name: Check for new Cascadia version

on: [push]

jobs:
  build:
    runs-on: ubuntu-18.04
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    steps:
    - uses: actions/checkout@v2
    - name: Find the latest Cascadia release version number
      run: |
        CASCADIATAG=`curl --silent "https://api.github.com/repos/microsoft/cascadia-code/releases/latest" | jq -r .tag_name`
        echo "Latest Cascadia tag is ${CASCADIATAG}"    
        git tag -l -n     
        if git rev-parse "${CASCADIATAG}" >/dev/null 2>&1; then
          echo "tag ${CASCADIATAG} exists";
        else
          echo "tag ${CASCADIATAG} does not exist, creating ..."
          git config user.name github-actions
          git config user.email github-actions@github.com
          git tag -a ${CASCADIATAG} -m "Version ${CASCADIATAG}"
        fi

# on:
#   schedule:
#     - cron: "5 23 * * *"
   
